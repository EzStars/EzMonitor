---
mode: ask
---
# EzMonitor SDK AI 编程指南

## 项目架构概览

EzMonitor 是一个前端监控 SDK，采用模块化设计：
- **核心模块** (`src/core/`): 配置管理、数据收集、上报机制
- **插件系统** (`src/plugins/`): 各种监控插件（性能、错误、用户行为等）
- **工具库** (`src/utils/`): 通用工具函数和助手
- **类型定义** (`src/types/`): TypeScript 类型定义

## 关键开发约定

### 配置管理模式
使用集中式配置对象，通过 `setConfig()` 和 `getConfig()` 管理：
```typescript
// 在 src/core/config/config.ts 中
const config: ConfigType = {
  url: 'http://127.0.0.1:3001/monitor',
  projectName: 'monitor',
  batchSize: 5,
  // ...
};
```

### 插件开发规范
- 每个插件应实现统一的生命周期钩子
- 使用 `containerElements` 和 `skeletonElements` 进行 DOM 监控
- 支持批量上报机制 (`batchSize` 配置)

### SourceMap 处理
集成 SourceMap 解析功能：
- `enableSourceMap`: 控制是否启用
- `sourceMapTimeout`: 3秒超时设置
- `sourceMapCacheSize`: 缓存最多50个文件

## 核心工作流

### 开发调试
- 使用 `isAjax: false` 进行本地调试
- 默认上报地址：`http://127.0.0.1:3001/monitor`
- 通过 `userId` 和 `appId` 区分不同项目/用户

### 数据上报机制
- 支持批量上报，默认批次大小为5
- 可配置的上报地址和项目标识
- 内置超时和缓存机制

## 关键文件位置

- `src/core/config/config.ts` - 核心配置管理
- `src/types/` - 所有 TypeScript 类型定义
- `packages/monitor-sdk/` - 主要 SDK 包

## 编码时注意事项

1. 所有配置项都应在 `ConfigType` 中定义类型
2. 使用 `setConfig()` 更新配置时会合并而非覆盖
3. DOM 监控使用预定义的容器元素选择器
4. SourceMap 功能默认关闭，需要显式启用
5. 用中文回答问题